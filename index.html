<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>View home with Sweet Home 3D HTML5 Viewer</title>

<script type="text/javascript" src="lib/big.min.js"></script>
<script type="text/javascript" src="lib/gl-matrix-min.js"></script>
<script type="text/javascript" src="lib/jszip.min.js"></script>
<script type="text/javascript" src="lib/core.min.js"></script>
<script type="text/javascript" src="lib/geom.min.js"></script>
<script type="text/javascript" src="lib/stroke.min.js"></script>
<script type="text/javascript" src="lib/batik-svgpathparser.min.js"></script>
<script type="text/javascript" src="lib/jsXmlSaxParser.min.js"></script>
<script type="text/javascript" src="lib/triangulator.min.js"></script>
<script type="text/javascript" src="lib/viewmodel.min.js"></script>
<script type="text/javascript" src="lib/viewhome.min.js"></script>

<style type="text/css">
/* Styles pour Full Screen et Responsive */
body, html {
  height: 100%;
  width: 100%;
  overflow: hidden; /* Empêche les barres de défilement indésirables */
  margin: 0;
}
#viewerCanvas {
  width: 100%;
  height: 100%;
  display: block; /* Évite les marges invisibles */
}

/* Le positionnement initial des contrôles de navigation (sera écrasé par le CSS plus loin) */
#viewerNavigationDiv {
  position: absolute; 
  bottom: 5px;
  left: 5px;
}

/* Styles pour les boutons - Améliorer la lisibilité et l'adaptabilité */
#viewerNavigationDiv div {
    display: inline-block; /* Aligne les groupes d'input/label */
    margin: 5px;
}
#levelsAndCameras {
    min-width: 150px;
}

/* 1. Positionnement global des boutons de navigation en haut à droite */
#viewerNavigationDiv {
  position: absolute !important;
  top: 10px !important; /* Marge du haut */
  right: 10px !important; /* Marge de droite */
  left: auto !important; /* Annuler l'ancien left: 5px */
  bottom: auto !important; /* Annuler l'ancien bottom: 5px */
  background-color: rgba(255, 255, 255, 0.8); /* Fond pour la lisibilité */
  padding: 5px;
  border-radius: 5px;
  display: flex; /* Utiliser Flexbox pour aligner les éléments */
  flex-direction: row; /* Aligner les éléments horizontalement par défaut */
  align-items: center;
  z-index: 100; /* Assurez-vous qu'ils sont au-dessus du canvas */
}

/* 2. Adaptation pour les petits écrans (Mobiles) */
@media (max-width: 768px) {
  #viewerNavigationDiv {
    /* Mettre les boutons les uns sous les autres sur mobile */
    flex-direction: column; 
    align-items: stretch; /* Étirer les boutons/select sur la largeur */
    
    /* Positionner en bas pour ne pas masquer le centre de la vue */
    top: auto !important; 
    bottom: 0px !important; 
    right: 0px !important;
    left: 0px !important;
    width: 100%;
    padding: 10px 0;
    background-color: rgba(255, 255, 255, 0.95);
  }
  
  #viewerNavigationDiv div, #viewerNavigationDiv select {
      width: 90%; /* Occuper une bonne partie de la largeur */
      margin: 5px auto;
  }
}

/* 3. Style visuel des boutons pour les rendre plus clairs */
#viewerNavigationDiv label, #viewerNavigationDiv select {
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
    cursor: pointer;
    background-color: #f9f9f9;
    font-size: 14px;
    display: inline-block; /* Pour les labels */
}

#viewerNavigationDiv input[type="radio"]:checked + label {
    background-color: #007bff;
    color: white;
    border-color: #007bff;
}

/* Cacher les inputs radio pour ne laisser que le label stylisé */
#viewerNavigationDiv input[type="radio"] {
    position: absolute;
    opacity: 0;
}
</style>
</head>

<body>
<div style="height: 100vh; width: 100vw; position: relative;">
  <canvas id="viewerCanvas" class="viewerComponent" 
            style="background-color: #CCCCCC; border: 1px solid gray; outline:none" tabIndex="1"></canvas>
  
  <div id="viewerProgressDiv" style="width: 80%; max-width: 400px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(128, 128, 128, 0.7); padding: 20px; border-radius: 25px; box-sizing: border-box;">
    <progress id="viewerProgress"  class="viewerComponent" value="0" max="200" style="width: 100%"></progress>
    <label id="viewerProgressLabel" class="viewerComponent" style="margin-top: 2px; display: block; margin-left: 10px; text-align: center; color: white;"></label>
  </div>
  
  <div id="viewerNavigationDiv" style="margin-top: 0;">
    <div>
      <input  id="aerialView"   class="viewerComponent" name="cameraType" type="radio" />
      <label class="viewerComponent" for="aerialView">Vue aérienne</label>
    </div>
    
    <div>
      <input  id="virtualVisit" class="viewerComponent" name="cameraType" type="radio" />
      <label class="viewerComponent" for="virtualVisit">Visite virtuelle</label>
    </div>
    
    <select id="levelsAndCameras" class="viewerComponent"></select>
  </div>
</div>

<div style="position: absolute; bottom: 5px; right: 5px; text-align: right; width: 95%; font-size: 10px; color: #555; z-index: 90;">
  <a href="http://www.sweethome3d.com">Sweet Home 3D</a> HTML5 Viewer / Version 1.9.1 - Distributed under GNU General Public License
</div>

<script type="text/javascript">
  // CORRECTION CRITIQUE: Le nom du fichier ZIP doit correspondre au fichier sur GitHub
  var homeUrl = "Le-cube-nantes.zip";
  
  var onerror = function(err) {
      if (err == "No WebGL") {
        alert("Sorry, your browser doesn't support WebGL.");
      } else {
        console.log(err.stack);
        alert("Error: " + 
  (err.message  ? err.constructor.name + " " +  err.message  : err)
            + (window.location.href.indexOf("file://") === 0 ? "\nCheck your browser is allowed to access local files." : ""));
      }
    };
  var onprogression = function(part, info, percentage) {
      var progress = document.getElementById("viewerProgress"); 
      if (part === HomeRecorder.READING_HOME) {
        // Home loading is finished 
        
  progress.value = percentage * 100;
        info = info.substring(info.lastIndexOf('/') + 1);
  } else if (part === Node3D.READING_MODEL) {
        // Models loading is finished 
        progress.value = 100 + percentage * 100;
  if (percentage === 1) {
          document.getElementById("viewerProgressDiv").style.visibility = "hidden";
  }
      }
      
      document.getElementById("viewerProgressLabel").innerHTML = 
          (percentage ? Math.floor(percentage * 100) + "% " : "") + part + " " + info;
  };
    
  // Display home in canvas 3D
  viewHome("viewerCanvas",       // Id of the canvas
            homeUrl,            // URL or relative URL of the home to display 
            onerror,            // Callback called in case of error
            onprogression,      // Callback called while loading 
           {roundsPerMinute: 0, 
            navigationPanel: "none",  // On utilise les boutons HTML
            aerialViewButtonId: "aerialView",       // Id of the aerial view radio button
            virtualVisitButtonId: "virtualVisit",   // Id of the aerial view radio button
            levelsAndCamerasListId: "levelsAndCameras",       // Id of the levels and cameras select component
            activateCameraSwitchKey: true 
            });
  </script>
</body>
</html>
